{% load static %}
<!-- Signin or Login Page -->

<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta Tags -->
    {% include 'main_app/common_meta.html' %}

    <!-- Link or CSS Tags -->
    {% include 'main_app/common_css.html' %}
    <link rel="stylesheet" href="{% static 'accounts/css/signup_style.css' %}">

    <title>Neerog - Doctor Registeration</title>

</head>
<body>

    <!-- Messages -->
    {% include 'main_app/show_messages.html' %}

    <!-- Navbar -->
    {% include 'main_app/navbar.html' %}

    <div class="doctorbg"></div>

    <form method="post" class="login-form" action="{% url 'register_doctor' %}" enctype="multipart/form-data">
    {% csrf_token %}
    <h1>Register - Doctor</h1>

    <div class="textb">
        <select name="is_independent" class="is_independent" required>
            <option value="True" selected>I'm Independent or Own A Clinic</option>
            <option value="False">I Work With A Hospital</option>
        </select>
    </div>

    <div class="textb">
        <input type="text" name="phone" required>
        <div class="placeholder">Phone or Mobile</div>
    </div>

    <div class="textb" style="width: 49%; float: left; height: 70px; ">
        <select name="gender" class="gender" required style="height: 70px;">
            <option value="Unknown" selected>Gender</option>
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Trans">Transgender</option>
        </select>
    </div>

    <div class="textb" style="width: 49%; float: right;">
        <input type="text" name="experience" required>
        <div class="placeholder">Years Of Experience</div>
    </div>

    <div class="textb" style="clear: left;">
        <select name="specialization" required>
            <option value="">Select Specialization</option>
            {% for sp in specialities%}
            <option value="{{sp}}">{{sp}}</option>            
            {% endfor %}
        </select>
    </div>

    <div class="textb">
        <input type="number" name="hospitalid" required>
        <div class="placeholder">Hospital Id</div>
    </div>

    <div class="textb" style="width: 49%; float: left;">
        <input type="text" name="cname" required>
        <div class="placeholder">Clinic Name</div>
    </div>

    <div class="textb" style="width: 49%; float: right;">
        <input type="text" name="fee" required>
        <div class="placeholder">Appointment Fee</div>
    </div>

    <div class="textb" style="clear:left; width: 49%; float: left; height: 60px; ">
        <select name="country" class="country" required style="height: 60px;">
            <option value="">Select Country</option>
            <option value="India">India</option>
            <option value="Other">Other</option>
        </select>
    </div>

    <div class="textb" style="width: 49%; float: right; height: 60px; ">
        <select name="city" class="city" required style="height: 60px;">
            <option value="">Select City</option>
            <option value="Delhi">Delhi</option>
            <option value="Other">Mumbai</option>
            <option value="Other">Kolkata</option>
            <option value="Other">Chennai</option>
        </select>
    </div>

    <div class="textb" style="clear:left;">
        <input type="text" name="area" required>
        <div class="placeholder">Clinic Address</div>
    </div>

    <div class="textb">
        <label for="cphoto" class="file_label">Clinic Photo</label>
        <input type="file" class="file_input" name="cphoto" required>
    </div>

    <div class="textb" style="clear:left;">
        <label for="proof" class="file_label">Proof of claimed qualification</label>
        <input type="file" class="file_input" name="proof" required>
    </div>
    
    <div class="textb form_feedback"></div>

    <button class="btn" disabled>Submit</button>
    </form>

    <script>

    function validateNumber(mynumber) 
    {
        if (/^\d+$/.test(mynumber))
        {
            return (true)
        }
        return (false)
    }

    function validatePhone(myphone)
    {
        if(myphone.length == 10 && validateNumber(myphone) == true)
        {
            return (true)
        }
        return (false)
    }

    function validateExperience(myexp)
    {
        if(myexp.length < 3 && myexp.length > 0 && validateNumber(myexp) == true)
        {
            return (true)
        }
        return (false)
    }

    function validateFile(filePath)
    {
        var allowedExtensions =  /(\.doc|\.docx|\.odt|\.pdf|\.jpeg|\.jpg|\.rtf|\.png)$/i;     
        if (!allowedExtensions.exec(filePath)) 
        { 
            filePath = '';
            return false;
        }
        else
        {
            return true;
        }
    }

    var fields = document.querySelectorAll(".textb input");
    var btn = document.querySelector(".btn");

    phone=fields[0];
    phone.addEventListener("keyup",check);

    specialization=fields[2];
    specialization.addEventListener("click",check);

    experience=fields[1];
    experience.addEventListener("keyup",check);

    institution=fields[2];
    institution.addEventListener("keyup",check);

    var fileInput =  document.querySelector('.file_input');
    fileInput.addEventListener("change",check);

    var feedback = document.querySelector(".form_feedback")
    function check()
    {
        if(institution.value != "")
        {
            if(validateFile(fileInput.value))
            {
                if(validatePhone(phone.value) == true)
                {
                    if(validateExperience(experience.value) == true)
                    {
                        if(specialization.value != "")
                        {
                            feedback.innerHTML = "";
                            btn.disabled = false;
                        }
                        else
                        {
                            feedback.innerHTML = "*Please Select Your Specialization.";
                            btn.disabled = true;
                        }
                    }
                    else
                    {
                        feedback.innerHTML = "*Please Enter Your Experience (In Years).";
                        btn.disabled = true;
                    }
                }
                else
                {
                    feedback.innerHTML = "*Please Enter A Valid Phone Number!";
                    btn.disabled = true;
                }
            }
            else
            {
                feedback.innerHTML = "*Please Submit Proof Of Claimed Qualification.";
                btn.disabled = true;
            }
        }
        else
        {
            feedback.innerHTML = "*Please Enter Your "+document.getElementById("institution_placeholder").innerHTML;
            btn.disabled = true;
        }       
    }

    var is_independent=document.querySelector(".textb .is_independent");
    is_independent.addEventListener("click",changeInstitute);
    is_independent.addEventListener("click",check);

    function changeInstitute()
    {
        if(is_independent.value == 'True')
        {
            document.getElementById("institution_placeholder").innerHTML = "Clinic Name";
        }
        else
        {
            document.getElementById("institution_placeholder").innerHTML = "Hospital Id";
        }
    } 


    </script>

    <!-- JavaScript -->
    {% include 'main_app/common_js.html' %}
</body>
</html> 